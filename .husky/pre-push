#!/usr/bin/env sh
. "$(dirname -- "$0")/husky.sh"

# Run Git LFS hook when available; otherwise no-op (silent)
if command -v git-lfs >/dev/null 2>&1; then
  git lfs pre-push "$@"
fi

# Style contract checks
pnpm check:styles

# Run lightweight test suite (node + dom tests, fast subset)
# Can be bypassed with: git push --no-verify
echo "Running pre-push test checks..."
if ! pnpm test:fast; then
  echo "‚ùå Pre-push tests failed. Run 'pnpm test' to see full output."
  echo "   To bypass: git push --no-verify"
  exit 1
fi

# Explicitly exit successfully to ensure git knows the hook completed
exit 0