# =============================================================================
# Corso Data Platform - Environment Configuration Template
# Copy this file to .env.local and fill in your actual values
# =============================================================================

# =============================================================================
# CORE APPLICATION CONFIGURATION
# =============================================================================

NODE_ENV=development
APP_VERSION=1.0.0
NEXT_PUBLIC_STAGE=development
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_API_URL=http://localhost:3000/api
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_APP_NAME=Corso Data Platform
NEXT_PUBLIC_APP_VERSION=1.0.0

# =============================================================================
# AUTHENTICATION (Clerk)
# =============================================================================

NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_your_clerk_publishable_key_here
CLERK_SECRET_KEY=sk_test_your_clerk_secret_key_here
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
# Default redirects to dashboard chat (per next.config.mjs: /dashboard redirects to /dashboard/chat)
NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL=/dashboard/chat
NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL=/dashboard/chat
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard/chat
# MVP: onboarding disabled, redirect to dashboard chat
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard/chat
CLERK_WEBHOOK_SECRET=whsec_your_webhook_secret_here
# Legacy: onboarding disabled for MVP
# NEXT_PUBLIC_CLERK_SIGN_UP_FORCE_REDIRECT_URL=/onboarding

# Auth Mode Configuration (Development)
# NEXT_PUBLIC_AUTH_MODE=strict (default) - requires org membership and RBAC
# NEXT_PUBLIC_AUTH_MODE=relaxed - allows any signed-in user (requires ALLOW_RELAXED_AUTH=true)
# ALLOW_RELAXED_AUTH=true - explicit opt-in required to enable relaxed mode
#
# ⚠️  RECOMMENDED: Use .env.development.local for relaxed auth mode
# This file is ONLY loaded in `next dev` (not during `next build`)
# This prevents production builds from failing due to relaxed auth mode
#
# Create .env.development.local with:
# NEXT_PUBLIC_AUTH_MODE=relaxed
# ALLOW_RELAXED_AUTH=true
#
# DO NOT set relaxed auth in .env.local - it will break production builds

# =============================================================================
# DATABASE (Supabase)
# =============================================================================

NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key_here
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=your_supabase_publishable_key_here
# Server-side Supabase URL (required for getSupabaseAdmin() calls)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here
SUPABASE_ACCESS_TOKEN=sbp_your_account_access_token_here

# =============================================================================
# PAYMENT PROCESSING (Stripe)
# =============================================================================

# Stripe Configuration - Required for billing
# Development: Using TEST keys (pk_test_ and sk_test_) to avoid real charges
# Production: Use LIVE keys (pk_live_ and sk_live_) in production environment only
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# =============================================================================
# ANALYTICS (ClickHouse)
# =============================================================================

CLICKHOUSE_HOST=https://your-instance.region.aws.clickhouse.cloud:8443
CLICKHOUSE_URL=https://your-instance.region.aws.clickhouse.cloud:8443
CLICKHOUSE_DATABASE=your_database_name
CLICKHOUSE_READONLY_USER=your_readonly_user
CLICKHOUSE_PASSWORD=your_clickhouse_password
CLICKHOUSE_TIMEOUT=30000
CLICKHOUSE_RATE_LIMIT_PER_MIN=1000
CLICKHOUSE_SLOW_QUERY_MS=5000

# =============================================================================
# AI INTEGRATION (OpenAI)
# =============================================================================

OPENAI_API_KEY=sk-proj-your_openai_api_key_here
OPENAI_ORG_ID=org-your_organization_id_here
OPENAI_SQL_MODEL=gpt-4
OPENAI_CHART_MODEL=gpt-3.5-turbo
OPENAI_TIMEOUT=30000
OPENAI_MAX_RETRIES=2
OPENAI_RATE_LIMIT_PER_MIN=60
OPENAI_SLOW_THRESHOLD_MS=5000
OPENAI_TOKENS_WARN_THRESHOLD=1000

# OpenAI Responses API Configuration (Sprint 0: scaffolding only)
# Kill switch for Responses API migration (default: false)
# When true, enables the new Responses API instead of Chat Completions API
AI_USE_RESPONSES=false
# Maximum number of tool calls allowed per request (default: 3)
AI_MAX_TOOL_CALLS=3
# Timeout for individual queries in milliseconds (default: 5000)
AI_QUERY_TIMEOUT_MS=5000
# Total timeout for all queries in milliseconds (default: 60000)
AI_TOTAL_TIMEOUT_MS=60000

# =============================================================================
# INTEGRATIONS & SERVICES
# =============================================================================

# Intercom Customer Support
NEXT_PUBLIC_INTERCOM_APP_ID=your_intercom_app_id_here
INTERCOM_API_KEY=your_intercom_api_key_here

# =============================================================================
# SECURITY & AUTHENTICATION
# =============================================================================

# Optional API key for rate limiting and authentication (not required in dev)
API_KEY=corso_dev_key

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

CORS_ORIGINS=*

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Sentry Error Tracking
SENTRY_DSN=https://your_sentry_dsn_here
NEXT_PUBLIC_SENTRY_DSN=https://your_public_sentry_dsn_here
SENTRY_ORG=your_sentry_org
SENTRY_PROJECT=your_sentry_project

# =============================================================================
# CACHING & SESSIONS (Redis)
# =============================================================================

# Upstash Redis Configuration
UPSTASH_REDIS_REST_URL=https://your-redis-instance.upstash.io
UPSTASH_REDIS_REST_TOKEN=your_upstash_redis_token_here

# =============================================================================
# SECURITY & COMPLIANCE
# =============================================================================

# Content Security Policy
CSP_SCRIPT_DOMAINS='self',js.stripe.com,js.clerk.dev
CSP_STYLE_DOMAINS='self',fonts.googleapis.com
CSP_FONT_DOMAINS='self',fonts.gstatic.com
CSP_IMG_DOMAINS='self',images.clerk.dev,js.stripe.com,your-project.supabase.co
CSP_CONNECT_DOMAINS='self',api.openai.com,api.stripe.com
CSP_FRAME_DOMAINS='self',js.stripe.com,accounts.clerk.dev
# CSP_REPORT_URI - DEPRECATED: Not used in code. Use CSP_FORWARD_URI for forwarding reports.
# CSP_REPORT_URI=/api/public/csp-report
CSP_REPORT_ONLY=false

# Cloudflare Turnstile (Bot Protection)
NEXT_PUBLIC_TURNSTILE_SITE_KEY=your_turnstile_site_key_here
TURNSTILE_SECRET_KEY=your_turnstile_secret_key_here

# External SSO Configuration
ENABLE_EXTERNAL_SSO=false

# AI RBAC Enforcement
# Set to false to temporarily bypass RBAC checks for AI endpoints (auth-only fallback)
# Default: true (enforced) in production
# WARNING: Only disable for emergency rollback scenarios
ENFORCE_AI_RBAC=true

# =============================================================================
# CONTENT & ASSETS
# =============================================================================

NEXT_PUBLIC_PLACEHOLDER_IMAGE_BASE=https://via.placeholder.com

# =============================================================================
# PERFORMANCE & OPTIMIZATION
# =============================================================================

AUTH_IDLE_TIMEOUT_MIN=30
PG_STAT_TOP_N=10

# =============================================================================
# DEVELOPMENT & DEBUGGING
# =============================================================================

VERCEL_ENV=development
NEXT_TELEMETRY_DISABLED=1
NEXT_PUBLIC_ONBOARDING_PREVIEW=1
npm_package_version=0.1.0

# Chromatic project token (local runs only; CI uses GitHub Actions secret)
CHROMATIC_PROJECT_TOKEN=chpt_your_chromatic_token_here

# CSP & Logging Controls (dev convenience)
CSP_DEBUG_HEADERS=false
CSP_REPORT_LOG=false
CSP_REPORT_MAX_LOGS=0
LOG_LEVEL=info

# =============================================================================
# AG GRID ENTERPRISE
# =============================================================================

# Set to '1' to enable AG Grid Enterprise (required for server-side row model)
NEXT_PUBLIC_AGGRID_ENTERPRISE=1
# AG Grid license key (removes watermark in production) - canonical name
NEXT_PUBLIC_AGGRID_LICENSE_KEY=your_ag_grid_license_key_here

# Legacy environment variable names (for backward compatibility)
NEXT_PUBLIC_AG_GRID_ENTERPRISE=1
NEXT_PUBLIC_AG_GRID_LICENSE_KEY=your_ag_grid_license_key_here

# =============================================================================
# SECURITY & AUTHENTICATION
# =============================================================================

# Optional API key for rate limiting and authentication (not required in dev)
API_KEY=corso_dev_key

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

CORS_ORIGINS=*

# =============================================================================
# OPTIONAL CONFIGURATION
# =============================================================================

# Mock Database Mode (Development)
# Set to 'true' to use mock JSON datasets instead of real Supabase DB
# Mock data is read from checked-in JSON fixtures in public/__mockdb__/
# CORSO_USE_MOCK_DB=true
# Legacy (deprecated): NEXT_PUBLIC_USE_MOCK_DB=true - Use CORSO_USE_MOCK_DB instead
# Organization ID used when mock DB is enabled (default: demo-org)
# CORSO_MOCK_ORG_ID=demo-org

# Mock CMS Mode (Development)
# Set to 'true' to use mock CMS JSON fixtures instead of real CMS or markdown files
# Mock content is read from checked-in JSON fixtures in public/__mockcms__/
# Dev/test: defaults to true unless explicitly false
# Production: defaults to false unless explicitly true
# CORSO_USE_MOCK_CMS=true

# CMS Provider Configuration
# Select CMS provider when not using mock CMS
# Options: 'legacy' (markdown/static), 'directus'
# Default: 'legacy'
# CORSO_CMS_PROVIDER=legacy

# Directus CMS Configuration (only used if CORSO_CMS_PROVIDER=directus)
# DIRECTUS_URL=https://your-directus-instance.com
# DIRECTUS_TOKEN=your_directus_token_here

# Rate Limiting (Development)
# Set to 'true' to disable edge rate limiter in development (not recommended for production)
# DISABLE_RATE_LIMIT=true

# Mock AI Mode (Development)
# Set to 'true' or '1' to bypass real OpenAI API calls and use mock responses
# Useful for UI/UX development and testing without backend connectivity
# NEXT_PUBLIC_USE_MOCK_AI=true

# Optional logging endpoint (can be omitted)
# LOGGING_ENDPOINT=https://your-logging-service.com/api/logs
