---
rule_id: component-design-system
title: Component Design System & Architecture (Consolidated)
owners:
  - design-system@corso.io
  - platform@corso.io
last_reviewed: "2025-10-13"
status: active
domains: [components, design-system, styles]
enforcement: warn
related_rules:
  - file-organization
  - code-quality-standards
alwaysApply: false
globs: ["components/**", "app/**/_components/**", "styles/**"]
summary: Atomic design patterns, import conventions, design system standards, and theming for React components.
---

# Component Design System & Architecture (Consolidated)

**Comprehensive guide to component architecture, atomic design patterns, import conventions, and design system standards.**

## TL;DR
- **Atomic Design**: Atoms ‚Üí Molecules ‚Üí Organisms ‚Üí Domain Modules
- **Import Conventions**: Use UI barrels (`@/atoms`, `@/molecules`, `@/organisms`) and domain facades
- **Intra-domain Rule**: Files under `components/**` must not import root barrels (`@/components`, `@/components/ui`)
- **Design System**: Use variant types from `@/styles/variants` and design tokens
- **Theming**: Route-based theming with `data-route-theme` attributes
- **Accessibility**: ARIA labels and axe testing required

## üèóÔ∏è Atomic Design & Component Structure

### Component Hierarchy
- **Atoms** ‚Üí **Molecules** ‚Üí **Organisms** ‚Üí **Domain Modules**
- **Domain Modules**: Feature-complete sections (dashboard/, onboarding/, marketing/, etc.)
- **Current Structure**: auth/, billing/, dashboard/, forms/, landing/, marketing/, onboarding/, ui/
- Place route-specific components under route `_components/` when applicable

### Component Organization
- **ui/**: Atomic design system (120+ components: 29 atoms, 27+ molecules, 24+ organisms)
- **Domain modules**: auth/ (5), billing/ (4), dashboard/ (19), forms/ (5), landing/ (15+), marketing/ (16), onboarding/ (29)

## Import Conventions

### Intra-Domain Import Guard (Critical)
Files under `components/**` must not import the root components barrels (`@/components`, `@/components/ui`). Import leaf modules (`atoms`, `molecules`, `organisms`) or use relative paths.

**Rationale**: Prevents circular dependencies between barrels and leaves; keeps UI layers modular.

**Enforcement**: ESLint (`no-restricted-imports`) and dependency-cruiser rule `no-components-root-barrel-from-components`.

## Design System & Variants

### Variant Types
- Use types from `@/styles/variants` or component-specific variants
- Use design tokens for responsive sizing

### Button Variants
- Allowed variants: `'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link' | 'waitlist' | 'waitlistBlue'`
- Allowed sizes: `'default' | 'sm' | 'lg' | 'icon'`
- Replace hardcoded viewport values with design tokens

### Design Tokens
- Use design tokens consistently from `@/styles/tokens`

## Theming (Route Groups)

### Theme Implementation
- Tokens target `:root[data-route-theme]`
- Default theme set on `<html data-route-theme="protected">` in `app/layout.tsx`
- Route groups like `(marketing)` set theme before paint via `next/script` (strategy: `beforeInteractive`)
- Maintain theme during client navigations with client helpers
- Keep theme logic confined to layout glue

For detailed theming patterns, see [extended documentation](../../docs/ai/rules/component-design-system.md#theming-patterns).

## Accessibility & Testing

### Accessibility Requirements
- Provide ARIA labels where needed
- Include axe checks in component tests
- Use semantic HTML elements
- Ensure keyboard navigation support

For testing standards and examples, see [extended documentation](../../docs/ai/rules/component-design-system.md#accessibility--testing).

## Animations

### Animation Guidelines
- Use React Spring (`@react-spring/web`) for complex animations
- Respect `prefers-reduced-motion` with built-in support
- Place animation logic in Client Components (`"use client"`)
- Keep Server Components for static content

For animation examples, see [extended documentation](../../docs/ai/rules/component-design-system.md#animations).

## Rules

- **MUST** use atomic design hierarchy: Atoms ‚Üí Molecules ‚Üí Organisms ‚Üí Domain Modules
- **MUST** use UI barrels (`@/atoms`, `@/molecules`, `@/organisms`) for external imports
- **MUST NOT** import root barrels (`@/components`, `@/components/ui`) from within `components/**`
- **MUST** use variant types from `@/styles/variants` or component-specific variants
- **MUST** use design tokens consistently (never hardcode values)
- **MUST** provide ARIA labels and include axe checks in component tests
- **SHOULD** use React Spring for complex animations

## Enforcement

### ESLint Rules (Planned)
The following ESLint rules are planned for future implementation:
- `@corso/component-import-boundaries`: Enforce import boundaries
- `@corso/design-system-variants`: Enforce variant types
- `@corso/accessibility-required`: Enforce accessibility

**Note**: These rules are not yet implemented in `eslint-plugin-corso`. Enforcement is currently handled via existing ESLint rules (e.g., `no-cross-domain-imports`, `forbid-ui-self-barrel`) and code review.

### Quality Gates
- **Development**: `pnpm typecheck`
- **Component Tests**: `pnpm test:components`
- **Accessibility**: `pnpm test:a11y`
- **Import Validation**: `pnpm audit:barrels --only intradomain`

For AST-Grep rules and extended examples, see [extended documentation](../../docs/ai/rules/component-design-system.md).

## Windows-first tips

See the canonical guidance in
[ai-agent-development-environment.mdc](mdc:.cursor/rules/ai-agent-development-environment.mdc#windows-first-tips).

## Related Rules

- `cursor/file-organization` - File structure and barrel usage
- `cursor/code-quality-standards` - Testing and quality standards
