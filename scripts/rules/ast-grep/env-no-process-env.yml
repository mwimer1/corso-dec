# Environment access rules (merged from ban-module-scope-env.yml)
# Module-scope env access in app/* is forbidden; use runtime-safe server helpers inside functions.
id: env-no-process-env
language: typescript
severity: error
message: "Use env utilities (getEnv/requireServerEnv/publicEnv) instead of direct process.env access."
rule:
  all:
    - pattern: "process.env.$VAR"
    - not:
        any:
          - regex:
              kind: file
              regex: "instrumentation\.ts$"
          - regex:
              kind: file
              regex: "lib/shared/config/client\.ts$"
          - regex:
              kind: file
              regex: "scripts/"
          - regex:
              kind: file
              regex: "tools/"
files:
  - "app/**/*.{ts,tsx}"
  - "components/**/*.{ts,tsx}"
  - "lib/**/*.{ts,tsx}"

